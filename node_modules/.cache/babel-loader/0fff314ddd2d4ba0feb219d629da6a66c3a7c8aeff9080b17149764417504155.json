{"ast":null,"code":"import React from\"react\";import{generateNonEditablePdfFromHtml,generateNonEditablePdfTemplate2}from\"../../utils/pdfGenerate\";import{jsx as _jsx}from\"react/jsx-runtime\";export default function PreviewPdfButton(_ref){let{getTablesHtml,templateType=1,pathFilename,// Par√¢metro para o caminho do ficheiro\n// Props espec√≠ficas para Template 2\natividades,donoProcesso,objetivoProcesso,indicadores,servicosEntrada,servicoSaida,history=[]// Novo prop para hist√≥rico\n}=_ref;// Fun√ß√£o para carregar automaticamente a imagem PNG da empresa\nconst loadCompanyImage=async()=>{try{const response=await fetch('/c_comenius_cor.png');if(response.ok){const arrayBuffer=await response.arrayBuffer();console.log(\"‚úÖ Imagem da empresa carregada para preview\");return new Uint8Array(arrayBuffer);}else{console.warn(\"‚ö†Ô∏è Imagem da empresa n√£o encontrada para preview\");return null;}}catch(error){console.error(\"‚ùå Erro ao carregar imagem da empresa para preview:\",error);return null;}};const handlePreviewNonEditable=async()=>{console.log(\"üîç DEBUG PreviewPdfButton - templateType:\",templateType);console.log(\"üîç DEBUG PreviewPdfButton - history recebido:\",history);console.log(\"üîç DEBUG PreviewPdfButton - history length:\",history===null||history===void 0?void 0:history.length);// Carregar a imagem PNG da empresa\nconst imageBytes=await loadCompanyImage();if(templateType===2){// Usa a fun√ß√£o espec√≠fica do Template 2\nconst nonEditablePdfBytes=await generateNonEditablePdfTemplate2(atividades,donoProcesso,objetivoProcesso,indicadores,servicosEntrada,servicoSaida,\"Procedimento\",imageBytes,pathFilename,history);const blob=new Blob([nonEditablePdfBytes],{type:\"application/pdf\"});const blobUrl=URL.createObjectURL(blob);window.open(blobUrl,\"_blank\");}else{// Template 1 - m√©todo original\nif(!getTablesHtml){alert(\"Fun√ß√£o getTablesHtml n√£o fornecida!\");return;}const{mainTableHtml,obsTableHtml}=getTablesHtml();console.log(\"üîç DEBUG PreviewPdfButton - mainTableHtml (primeiros 500 chars):\",mainTableHtml===null||mainTableHtml===void 0?void 0:mainTableHtml.substring(0,500));const nonEditablePdfBytes=await generateNonEditablePdfFromHtml(mainTableHtml,obsTableHtml,\"Procedimento\",imageBytes,pathFilename||\"\",history);const blob=new Blob([nonEditablePdfBytes],{type:\"application/pdf\"});const blobUrl=URL.createObjectURL(blob);window.open(blobUrl,\"_blank\");}};return/*#__PURE__*/_jsx(\"button\",{className:\"preview-button\",onClick:handlePreviewNonEditable,children:\"Download\"});}","map":{"version":3,"names":["React","generateNonEditablePdfFromHtml","generateNonEditablePdfTemplate2","jsx","_jsx","PreviewPdfButton","_ref","getTablesHtml","templateType","pathFilename","atividades","donoProcesso","objetivoProcesso","indicadores","servicosEntrada","servicoSaida","history","loadCompanyImage","response","fetch","ok","arrayBuffer","console","log","Uint8Array","warn","error","handlePreviewNonEditable","length","imageBytes","nonEditablePdfBytes","blob","Blob","type","blobUrl","URL","createObjectURL","window","open","alert","mainTableHtml","obsTableHtml","substring","className","onClick","children"],"sources":["C:/Users/Ant√≥nio Gon√ßalves/Desktop/Magna-ISO9001-Frontend/src/components/Buttons/previewPDF.jsx"],"sourcesContent":["import React from \"react\";\r\nimport { generateNonEditablePdfFromHtml, generateNonEditablePdfTemplate2 } from \"../../utils/pdfGenerate\";\r\n\r\nexport default function PreviewPdfButton({ \r\n  getTablesHtml, \r\n  templateType = 1,\r\n  pathFilename, // Par√¢metro para o caminho do ficheiro\r\n  // Props espec√≠ficas para Template 2\r\n  atividades,\r\n  donoProcesso,\r\n  objetivoProcesso,\r\n  indicadores,\r\n  servicosEntrada,\r\n  servicoSaida,\r\n  history = [] // Novo prop para hist√≥rico\r\n}) {\r\n  // Fun√ß√£o para carregar automaticamente a imagem PNG da empresa\r\n  const loadCompanyImage = async () => {\r\n    try {\r\n      const response = await fetch('/c_comenius_cor.png');\r\n      if (response.ok) {\r\n        const arrayBuffer = await response.arrayBuffer();\r\n        console.log(\"‚úÖ Imagem da empresa carregada para preview\");\r\n        return new Uint8Array(arrayBuffer);\r\n      } else {\r\n        console.warn(\"‚ö†Ô∏è Imagem da empresa n√£o encontrada para preview\");\r\n        return null;\r\n      }\r\n    } catch (error) {\r\n      console.error(\"‚ùå Erro ao carregar imagem da empresa para preview:\", error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const handlePreviewNonEditable = async () => {\r\n    console.log(\"üîç DEBUG PreviewPdfButton - templateType:\", templateType);\r\n    console.log(\"üîç DEBUG PreviewPdfButton - history recebido:\", history);\r\n    console.log(\"üîç DEBUG PreviewPdfButton - history length:\", history?.length);\r\n    \r\n    // Carregar a imagem PNG da empresa\r\n    const imageBytes = await loadCompanyImage();\r\n    \r\n    if (templateType === 2) {\r\n      // Usa a fun√ß√£o espec√≠fica do Template 2\r\n      const nonEditablePdfBytes = await generateNonEditablePdfTemplate2(\r\n        atividades,\r\n        donoProcesso,\r\n        objetivoProcesso,\r\n        indicadores,\r\n        servicosEntrada,\r\n        servicoSaida,\r\n        \"Procedimento\",\r\n        imageBytes,\r\n        pathFilename,\r\n        history\r\n      );\r\n      const blob = new Blob([nonEditablePdfBytes], { type: \"application/pdf\" });\r\n      const blobUrl = URL.createObjectURL(blob);\r\n      window.open(blobUrl, \"_blank\");\r\n    } else {\r\n      // Template 1 - m√©todo original\r\n      if (!getTablesHtml) {\r\n        alert(\"Fun√ß√£o getTablesHtml n√£o fornecida!\");\r\n        return;\r\n      }\r\n      const { mainTableHtml, obsTableHtml } = getTablesHtml();\r\n      console.log(\"üîç DEBUG PreviewPdfButton - mainTableHtml (primeiros 500 chars):\", mainTableHtml?.substring(0, 500));\r\n      \r\n      const nonEditablePdfBytes = await generateNonEditablePdfFromHtml(\r\n        mainTableHtml, \r\n        obsTableHtml, \r\n        \"Procedimento\", \r\n        imageBytes, \r\n        pathFilename || \"\",\r\n        history\r\n      );\r\n      const blob = new Blob([nonEditablePdfBytes], { type: \"application/pdf\" });\r\n      const blobUrl = URL.createObjectURL(blob);\r\n      window.open(blobUrl, \"_blank\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <button className=\"preview-button\" onClick={handlePreviewNonEditable}>\r\n      Download\r\n    </button>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}