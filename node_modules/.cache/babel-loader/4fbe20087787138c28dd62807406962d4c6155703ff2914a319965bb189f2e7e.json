{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{createPortal}from'react-dom';import'./RowContextMenuNew.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const useRowContextMenu=_ref=>{let{totalRows,onMoveRowUp,onMoveRowDown,onInsertRowAbove,onInsertRowBelow,onDeleteRow}=_ref;const[isOpen,setIsOpen]=useState(false);const[position,setPosition]=useState({x:0,y:0});const[currentRowIndex,setCurrentRowIndex]=useState(0);const menuRef=useRef(null);const handleContextMenuEvent=(e,rowIndex)=>{e.preventDefault();setCurrentRowIndex(rowIndex);// Calcular posiÃ§Ã£o do menu evitando que saia da tela\nlet x=e.clientX;let y=e.clientY;const menuWidth=180;const menuHeight=200;if(x+menuWidth>window.innerWidth){x=window.innerWidth-menuWidth-10;}if(y+menuHeight>window.innerHeight){y=window.innerHeight-menuHeight-10;}setPosition({x,y});setIsOpen(true);};const handleContextMenu=rowIndex=>e=>{handleContextMenuEvent(e,rowIndex);};const closeMenu=()=>{setIsOpen(false);};const handleAction=function(action){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}action(...args);closeMenu();};useEffect(()=>{const handleClickOutside=event=>{if(menuRef.current&&!menuRef.current.contains(event.target)){closeMenu();}};const handleScroll=()=>{closeMenu();};if(isOpen){// Adicionar listeners com um pequeno delay para evitar o fechamento imediato\nsetTimeout(()=>{document.addEventListener('mousedown',handleClickOutside);document.addEventListener('scroll',handleScroll);// Removido o listener de contextmenu que estava causando o problema\n},10);}return()=>{document.removeEventListener('mousedown',handleClickOutside);document.removeEventListener('scroll',handleScroll);};},[isOpen]);const menuItems=[{label:'Mover para cima',icon:'â†‘',action:()=>handleAction(onMoveRowUp,currentRowIndex),disabled:currentRowIndex===0,className:'move-up'},{label:'Mover para baixo',icon:'â†“',action:()=>handleAction(onMoveRowDown,currentRowIndex),disabled:currentRowIndex===totalRows-1,className:'move-down'},{type:'separator'},{label:'Inserir linha acima',icon:'â¬†',action:()=>handleAction(onInsertRowAbove,currentRowIndex),className:'insert-above'},{label:'Inserir linha abaixo',icon:'â¬‡',action:()=>handleAction(onInsertRowBelow,currentRowIndex),className:'insert-below'},{type:'separator'},{label:'Apagar linha',icon:'ðŸ—‘',action:()=>handleAction(onDeleteRow,currentRowIndex),disabled:totalRows<=1,className:'delete-row'}];const contextMenu=isOpen?/*#__PURE__*/createPortal(/*#__PURE__*/_jsx(\"div\",{ref:menuRef,className:\"context-menu\",style:{position:'fixed',left:\"\".concat(position.x,\"px\"),top:\"\".concat(position.y,\"px\"),zIndex:999999},children:menuItems.map((item,index)=>{if(item.type==='separator'){return/*#__PURE__*/_jsx(\"div\",{className:\"context-menu-separator\"},index);}return/*#__PURE__*/_jsxs(\"button\",{className:\"context-menu-item \".concat(item.className||'',\" \").concat(item.disabled?'disabled':''),onClick:item.action,disabled:item.disabled,children:[/*#__PURE__*/_jsx(\"span\",{className:\"context-menu-icon\",children:item.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"context-menu-label\",children:item.label})]},index);})}),document.body):null;return{handleContextMenu,handleContextMenuEvent,contextMenu};};export default useRowContextMenu;","map":{"version":3,"names":["React","useState","useEffect","useRef","createPortal","jsx","_jsx","jsxs","_jsxs","useRowContextMenu","_ref","totalRows","onMoveRowUp","onMoveRowDown","onInsertRowAbove","onInsertRowBelow","onDeleteRow","isOpen","setIsOpen","position","setPosition","x","y","currentRowIndex","setCurrentRowIndex","menuRef","handleContextMenuEvent","e","rowIndex","preventDefault","clientX","clientY","menuWidth","menuHeight","window","innerWidth","innerHeight","handleContextMenu","closeMenu","handleAction","action","_len","arguments","length","args","Array","_key","handleClickOutside","event","current","contains","target","handleScroll","setTimeout","document","addEventListener","removeEventListener","menuItems","label","icon","disabled","className","type","contextMenu","ref","style","left","concat","top","zIndex","children","map","item","index","onClick","body"],"sources":["C:/Users/alex_/Magna-ISO9001/src/components/ContextMenu/useRowContextMenu.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport './RowContextMenuNew.css';\r\n\r\nconst useRowContextMenu = ({ \r\n  totalRows,\r\n  onMoveRowUp, \r\n  onMoveRowDown, \r\n  onInsertRowAbove, \r\n  onInsertRowBelow, \r\n  onDeleteRow \r\n}) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [position, setPosition] = useState({ x: 0, y: 0 });\r\n  const [currentRowIndex, setCurrentRowIndex] = useState(0);\r\n  const menuRef = useRef(null);\r\n\r\n  const handleContextMenuEvent = (e, rowIndex) => {\r\n    e.preventDefault();\r\n    setCurrentRowIndex(rowIndex);\r\n    \r\n    // Calcular posiÃ§Ã£o do menu evitando que saia da tela\r\n    let x = e.clientX;\r\n    let y = e.clientY;\r\n    \r\n    const menuWidth = 180;\r\n    const menuHeight = 200;\r\n    \r\n    if (x + menuWidth > window.innerWidth) {\r\n      x = window.innerWidth - menuWidth - 10;\r\n    }\r\n    \r\n    if (y + menuHeight > window.innerHeight) {\r\n      y = window.innerHeight - menuHeight - 10;\r\n    }\r\n    \r\n    setPosition({ x, y });\r\n    setIsOpen(true);\r\n  };\r\n\r\n  const handleContextMenu = (rowIndex) => (e) => {\r\n    handleContextMenuEvent(e, rowIndex);\r\n  };\r\n\r\n  const closeMenu = () => {\r\n    setIsOpen(false);\r\n  };\r\n\r\n  const handleAction = (action, ...args) => {\r\n    action(...args);\r\n    closeMenu();\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n        closeMenu();\r\n      }\r\n    };\r\n\r\n    const handleScroll = () => {\r\n      closeMenu();\r\n    };\r\n\r\n    if (isOpen) {\r\n      // Adicionar listeners com um pequeno delay para evitar o fechamento imediato\r\n      setTimeout(() => {\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        document.addEventListener('scroll', handleScroll);\r\n        // Removido o listener de contextmenu que estava causando o problema\r\n      }, 10);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n      document.removeEventListener('scroll', handleScroll);\r\n    };\r\n  }, [isOpen]);\r\n\r\n  const menuItems = [\r\n    {\r\n      label: 'Mover para cima',\r\n      icon: 'â†‘',\r\n      action: () => handleAction(onMoveRowUp, currentRowIndex),\r\n      disabled: currentRowIndex === 0,\r\n      className: 'move-up'\r\n    },\r\n    {\r\n      label: 'Mover para baixo',\r\n      icon: 'â†“',\r\n      action: () => handleAction(onMoveRowDown, currentRowIndex),\r\n      disabled: currentRowIndex === totalRows - 1,\r\n      className: 'move-down'\r\n    },\r\n    { type: 'separator' },\r\n    {\r\n      label: 'Inserir linha acima',\r\n      icon: 'â¬†',\r\n      action: () => handleAction(onInsertRowAbove, currentRowIndex),\r\n      className: 'insert-above'\r\n    },\r\n    {\r\n      label: 'Inserir linha abaixo',\r\n      icon: 'â¬‡',\r\n      action: () => handleAction(onInsertRowBelow, currentRowIndex),\r\n      className: 'insert-below'\r\n    },\r\n    { type: 'separator' },\r\n    {\r\n      label: 'Apagar linha',\r\n      icon: 'ðŸ—‘',\r\n      action: () => handleAction(onDeleteRow, currentRowIndex),\r\n      disabled: totalRows <= 1,\r\n      className: 'delete-row'\r\n    }\r\n  ];\r\n\r\n  const contextMenu = isOpen ? createPortal(\r\n    <div\r\n      ref={menuRef}\r\n      className=\"context-menu\"\r\n      style={{\r\n        position: 'fixed',\r\n        left: `${position.x}px`,\r\n        top: `${position.y}px`,\r\n        zIndex: 999999\r\n      }}\r\n    >\r\n      {menuItems.map((item, index) => {\r\n        if (item.type === 'separator') {\r\n          return <div key={index} className=\"context-menu-separator\" />;\r\n        }\r\n\r\n        return (\r\n          <button\r\n            key={index}\r\n            className={`context-menu-item ${item.className || ''} ${item.disabled ? 'disabled' : ''}`}\r\n            onClick={item.action}\r\n            disabled={item.disabled}\r\n          >\r\n            <span className=\"context-menu-icon\">{item.icon}</span>\r\n            <span className=\"context-menu-label\">{item.label}</span>\r\n          </button>\r\n        );\r\n      })}\r\n    </div>,\r\n    document.body\r\n  ) : null;\r\n\r\n  return {\r\n    handleContextMenu,\r\n    handleContextMenuEvent,\r\n    contextMenu\r\n  };\r\n};\r\n\r\nexport default useRowContextMenu;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}